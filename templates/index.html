<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Portfolio Grader</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body class="min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <header class="mb-8">
            <h1 class="text-3xl font-bold mb-2">Eavest - Financial Portfolio Analyst</h1>
            <p class="text-gray-600 dark:text-gray-300">Build, analyse, and project your investment portfolio</p>
            <div class="mt-3 p-3 bg-yellow-50 dark:bg-gray-800 border border-yellow-200 dark:border-gray-700 rounded-md text-yellow-800 dark:text-yellow-200 text-sm">
                <strong>Disclaimer:</strong> This tool is for educational and informational purposes only. It does not constitute investment advice. The projections and analyses generated by AI may not be accurate and should not be the sole basis for investment decisions. Always consult with a qualified financial advisor before making investment choices.
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Portfolio Builder Panel -->
            <div class="md:col-span-1">
                <div class="card rounded-lg shadow-md p-4 mb-6 border border-custom">
                    <h2 class="text-xl font-semibold mb-4">Portfolio Builder</h2>
                    
                    <div class="mb-4">
                        <label class="block mb-2">Initial Investment</label>
                        <div class="flex items-center">
                            <span class="mr-2">$</span>
                            <input type="number" id="initialInvestment" class="w-full p-2 rounded border text-base" value="10000" min="0">
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block mb-2">Recurring Investment</label>
                        <div class="grid grid-cols-2 gap-2 mb-2">
                            <input type="number" id="recurringAmount" class="w-full p-2 rounded border text-base" value="500" min="0">
                            <select id="recurringFrequency" class="w-full p-2 rounded border text-base">
                                <option value="weekly">Weekly</option>
                                <option value="monthly" selected>Monthly</option>
                                <option value="yearly">Yearly</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-4">
                        <details>
                            <summary class="cursor-pointer p-2 bg-custom rounded font-medium">Advanced Investment Plan</summary>
                            <div class="p-3 border border-custom rounded mt-2">
                                <div class="mb-2">
                                    <label class="block mb-1">After <input type="number" id="changeYear" class="w-16 p-1 text-center rounded border text-base" value="3" min="1"> years</label>
                                </div>
                                <div class="mb-2">
                                    <label class="block mb-1">Change recurring amount to:</label>
                                    <div class="flex items-center">
                                        <span class="mr-2">$</span>
                                        <input type="number" id="newRecurringAmount" class="w-full p-2 rounded border text-base" value="1000" min="0">
                                    </div>
                                </div>
                            </div>
                        </details>
                    </div>

                    <div class="mb-4">
                        <label class="block mb-2">Add Asset</label>
                        <div class="grid grid-cols-1 gap-2 mb-2">
                            <div class="flex">
                                <select id="assetType" class="p-2 rounded-l border text-base">
                                    <option value="stock">Stock</option>
                                    <option value="commodity">Commodity</option>
                                    <option value="bond">Bond</option>
                                    <option value="index">Index</option>
                                    <option value="crypto">Cryptocurrency</option>
                                    <option value="currency">Cash/ Currency</option>
                                </select>
                                <input type="text" id="assetSymbol" placeholder="e.g. AAPL, NVDA" class="flex-1 p-2 border-l-0 border text-base">
                            </div>
                            <div id="assetSubType">
                                <select id="commodityType" class="w-full p-2 rounded border text-base hidden">
                                    <option value="GC=F">Gold</option>
                                    <option value="SI=F">Silver</option>
                                    <option value="HG=F">Copper</option>
                                    <option value="CL=F">Crude Oil</option>
                                    <option value="NG=F">Natural Gas</option>
                                </select>
                                <select id="bondType" class="w-full p-2 rounded border text-base hidden">
                                    <option value="^TNX">10-Year Treasury (Long Term)</option>
                                    <option value="^FVX">5-Year Treasury (Medium Term)</option>
                                    <option value="^IRX">13-Week Treasury (Short Term)</option>
                                </select>
                                <select id="indexType" class="w-full p-2 rounded border text-base hidden">
                                    <option value="^GSPC">S&P 500</option>
                                    <option value="^DJI">Dow Jones</option>
                                    <option value="^IXIC">NASDAQ</option>
                                    <option value="^RUT">Russell 2000</option>
                                    <option value="^N225">Nikkei 225 (Japan)</option>
                                    <option value="^HSI">Hang Seng Index (Hong Kong)</option>
                                    <option value="^FTSE">FTSE 100 (UK)</option>
                                    <option value="^GDAXI">DAX (Germany)</option>
                                    <option value="^FCHI">CAC 40 (France)</option>
                                    <option value="^STOXX50E">EURO STOXX 50</option>
                                    <option value="^SSEC">Shanghai Composite</option>
                                    <option value="^BSESN">BSE SENSEX (India)</option>
                                </select>
                                <select id="cryptoType" class="w-full p-2 rounded border text-base hidden">
                                    <option value="BTC-USD">Bitcoin (BTC)</option>
                                    <option value="ETH-USD">Ethereum (ETH)</option>
                                    <option value="SOL-USD">Solana (SOL)</option>
                                    <option value="ADA-USD">Cardano (ADA)</option>
                                    <option value="DOT-USD">Polkadot (DOT)</option>
                                    <option value="AVAX-USD">Avalanche (AVAX)</option>
                                    <option value="LINK-USD">Chainlink (LINK)</option>
                                    <option value="MATIC-USD">Polygon (MATIC)</option>
                                    <option value="XRP-USD">XRP (Ripple)</option>
                                    <option value="BNB-USD">Binance Coin (BNB)</option>
                                </select>
                                <select id="currencyType" class="w-full p-2 rounded border text-base hidden">
                                    <option value="USD=X">US Dollar (USD)</option>
                                    <option value="EURUSD=X">Euro to USD (EUR/USD)</option>
                                    <option value="GBPUSD=X">British Pound to USD (GBP/USD)</option>
                                    <option value="JPYUSD=X">Japanese Yen to USD (JPY/USD)</option>
                                    <option value="CHFUSD=X">Swiss Franc to USD (CHF/USD)</option>
                                    <option value="AUDUSD=X">Australian Dollar to USD (AUD/USD)</option>
                                    <option value="CADUSD=X">Canadian Dollar to USD (CAD/USD)</option>
                                    <option value="NZDUSD=X">New Zealand Dollar to USD (NZD/USD)</option>
                                    <option value="CNYUSD=X">Chinese Yuan to USD (CNY/USD)</option>
                                    <option value="HKDUSD=X">Hong Kong Dollar to USD (HKD/USD)</option>
                                    <option value="SGDUSD=X">Singapore Dollar to USD (SGD/USD)</option>
                                    <option value="INRUSD=X">Indian Rupee to USD (INR/USD)</option>
                                </select>
                            </div>
                            <div class="flex items-center">
                                <label class="block mr-2">Allocation:</label>
                                <input type="range" id="allocationSlider" min="1" max="100" value="20" class="flex-1 mr-2">
                                <input type="number" id="allocationInput" class="w-16 p-1 text-center rounded border text-base" value="20" min="1" max="100">
                                <span class="ml-1">%</span>
                            </div>
                        </div>
                        <button id="addAssetBtn" class="w-full p-2 mt-2 btn-primary rounded">Add to Portfolio</button>
                    </div>

                    <div id="currentPortfolio" class="mb-4">
                        <h3 class="font-semibold mb-2">Current Portfolio</h3>
                        <div id="assetList" class="space-y-2"></div>
                        <div id="allocationWarning" class="text-red-500 text-sm mt-2 hidden">
                            Warning: Total allocation does not equal 100%
                        </div>
                    </div>

                    <button id="analyseBtn" class="w-full p-2 btn-primary rounded">Analyse Portfolio</button>
                </div>

                <div class="card rounded-lg shadow-md p-4 border border-custom">
                    <h2 class="text-xl font-semibold mb-4">Customisation Guide</h2>
                    <div class="space-y-3 text-sm">
                        <div>
                            <h3 class="font-semibold">Adding Custom Stocks:</h3>
                            <p>Enter any valid stock symbol (e.g., NVDA, AAPL) in the asset symbol field.</p>
                        </div>
                        <div>
                            <h3 class="font-semibold">Using Commodities:</h3>
                            <p>Select "Commodity" from the asset type dropdown and choose from available options.</p>
                        </div>
                        <div>
                            <h3 class="font-semibold">Investment Planning:</h3>
                            <p>Adjust initial investment, recurring contributions, and use the Advanced Investment Plan to model changes over time.</p>
                        </div>
                        <div>
                            <h3 class="font-semibold">Note on Data:</h3>
                            <p>Historical data is fetched from Yahoo Finance API and may take a moment to load.</p>
                        </div>
                    </div>
                </div>

                <div class="mt-6 border border-custom rounded-lg overflow-hidden">
                    <div class="bg-gray-100 dark:bg-gray-800 p-3 border-b border-custom">
                        <h3 class="font-semibold">Portfolio Assistant</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Ask questions about your portfolio analysis</p>
                    </div>
                    <div id="chatMessages" class="p-4 max-h-80 overflow-y-auto space-y-3">
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-sm">
                            <p>Hello! I'm your portfolio assistant. After analysing your portfolio, I can answer specific questions about your investments, risk assessment, or potential strategies. What would you like to know?</p>
                        </div>
                    </div>
                    <div class="p-3 border-t border-custom">
                        <div class="flex">
                            <input type="text" id="chatInput" placeholder="Ask a question about your portfolio..." class="flex-1 p-2 rounded-l border-l border-t border-b text-base" />
                            <button id="sendChatBtn" class="btn-primary rounded-r px-4">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>



            </div>

            <!-- Analysis and Results Panel -->
            <div class="md:col-span-2">
                <div class="card rounded-lg shadow-md p-4 mb-6 border border-custom">
                    <div class="flex border-b border-custom mb-4">
                        <div id="tab-overview" class="tab active p-2 border-b-2 border-primary-500 font-medium">Overview</div>
                        <div id="tab-projections" class="tab p-2 font-medium">Projections</div>
                        <div id="tab-news" class="tab p-2 font-medium">Market News</div>
                        <div id="tab-report" class="tab p-2 font-medium">Report</div>
                    </div>

                    <div id="content-overview" class="tab-content">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <h3 class="font-semibold mb-2">Portfolio Allocation</h3>
                                <div class="portfolio-composition">
                                    <canvas id="portfolioChart"></canvas>
                                </div>
                            </div>
                            <div>
                                <h3 class="font-semibold mb-2">Portfolio Value Over Time</h3>
                                <div class="chart-container">
                                    <canvas id="portfolioValueChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h3 class="font-semibold mb-2">Market Sentiment</h3>
                            <div class="sentiment-meter mb-1">
                                <div class="meter-background"></div>
                                <div id="sentimentFill" class="meter-fill" style="width: 50%;"></div>
                                <div id="sentimentMarker" class="meter-marker" style="left: 50%;"></div>
                            </div>
                            <div class="flex justify-between text-xs">
                                <span>Very Negative</span>
                                <span>Neutral</span>
                                <span>Very Positive</span>
                            </div>
                        </div>

                        <div id="portfolioSummary" class="p-4 border border-custom rounded-lg">
                            <h3 class="font-semibold mb-2">Portfolio Summary</h3>
                            <p>Add assets to your portfolio and click "Analyse Portfolio" to see insights.</p>
                        </div>
                    </div>

                    <div id="content-projections" class="tab-content hidden">
                        <div class="mb-4">
                            <h3 class="font-semibold mb-2">Growth Projections</h3>
                            <div class="grid grid-cols-1 gap-4">
                                <div class="chart-container">
                                    <canvas id="growthProjectionChart"></canvas>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="border border-custom p-3 rounded">
                                        <h4 class="font-medium mb-1">5-Year Projection</h4>
                                        <div id="fiveYearProjection">Add assets to see projection</div>
                                    </div>
                                    <div class="border border-custom p-3 rounded">
                                        <h4 class="font-medium mb-1">10-Year Projection</h4>
                                        <div id="tenYearProjection">Add assets to see projection</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="assetDetailContainer" class="space-y-4">
                            <h3 class="font-semibold mb-2">Individual Asset Performance</h3>
                            <p>Add assets to see individual performance projections</p>
                        </div>
                    </div>

                    <div id="content-news" class="tab-content hidden">
                        <h3 class="font-semibold mb-2">Recent Market News</h3>
                        <div id="newsContainer" class="space-y-3">
                            <p>Add assets to see relevant news</p>
                        </div>
                    </div>

                    <div id="content-report" class="tab-content hidden">
                        <h3 class="font-semibold mb-4">Portfolio Analysis Report</h3>
                        <div id="portfolioReport" class="p-4 border border-custom rounded-lg">
                            <p>Add assets to your portfolio and click "Analyse Portfolio" to generate a report.</p>
                        </div>
                        
                        <!-- Portfolio Assistant Chat -->
                        <!-- <div class="mt-6 border border-custom rounded-lg overflow-hidden">
                            <div class="bg-gray-100 dark:bg-gray-800 p-3 border-b border-custom">
                                <h3 class="font-semibold">Portfolio Assistant</h3>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Ask questions about your portfolio analysis</p>
                            </div>
                            <div id="chatMessages" class="p-4 max-h-80 overflow-y-auto space-y-3">
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-sm">
                                    <p>Hello! I'm your portfolio assistant. After analyzing your portfolio, I can answer specific questions about your investments, risk assessment, or potential strategies. What would you like to know?</p>
                                </div>
                            </div>
                            <div class="p-3 border-t border-custom">
                                <div class="flex">
                                    <input type="text" id="chatInput" placeholder="Ask a question about your portfolio..." class="flex-1 p-2 rounded-l border-l border-t border-b text-base" />
                                    <button id="sendChatBtn" class="btn-primary rounded-r px-4">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-8 py-4 text-center text-sm text-gray-600 dark:text-gray-400 border-t border-custom">
        &copy; <span id="currentYear"></span> Eavest by <a href="https://www.oscarsoai.com" class="text-primary-600 hover:underline">Oscar So</a>. All rights reserved.
    </footer>

    <div id="tooltip" class="tooltip"></div>
    <script src="{{ url_for('static', filename='script_v2.js') }}"></script>
</body>
</html>